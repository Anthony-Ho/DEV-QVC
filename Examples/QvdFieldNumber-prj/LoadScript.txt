///$tab Main
SET ThousandSep=',';
SET DecimalSep='.';
SET MoneyThousandSep=',';
SET MoneyDecimalSep='.';
SET MoneyFormat='$#,##0.00;($#,##0.00)';
SET TimeFormat='h:mm:ss TT';
SET DateFormat='M/D/YYYY';
SET TimestampFormat='M/D/YYYY h:mm:ss[.fff] TT';
SET MonthNames='Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec';
SET DayNames='Mon;Tue;Wed;Thu;Fri;Sat;Sun';

///$tab Includes
$(Include=..\qvc_runtime\qvc.qvs);
///$tab Use QvdFieldNumber
// Create a sample qvd to demo with
FieldNumberSample:
LOAD 
	'x' as [Customer Name]
	,99 as Amount
AutoGenerate 1
;
STORE FieldNumberSample INTO [QVD\FieldNumberSample.qvd] (qvd);	
DROP TABLE FieldNumberSample;


//=== Test the QvdFieldNumber routine ===

// All parameters, field should be found
CALL Qvc.QvdFieldNumber('Customer Name', 'QVD\FieldNumberSample.qvd', 'vReturn');
CALL Qvc.Log('Customer Name = $(vReturn)');

// Use the default return variable of Qvc.v.Return 
CALL Qvc.QvdFieldNumber('Amount', 'QVD\FieldNumberSample.qvd');
CALL Qvc.Log('Amount = $(Qvc.v.Return)');

// Field should not be found 
CALL Qvc.QvdFieldNumber('BadField', 'QVD\FieldNumberSample.qvd');
CALL Qvc.Log('BadField = $(Qvc.v.Return)');

// QVD does not exist, should return 0
CALL Qvc.QvdFieldNumber('BadField', 'QVD\notfoundfile.qvd');
CALL Qvc.Log('Bad QVD filename = $(Qvc.v.Return)');




///$tab Cleanup
// Cleanup Qvc
SET vReturn=;
SET Qvc.v.Return=;

CALL Qvc.Cleanup;
