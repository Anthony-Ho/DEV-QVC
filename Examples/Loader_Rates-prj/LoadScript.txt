///$tab Main
SET ThousandSep=',';
SET DecimalSep='.';
SET MoneyThousandSep=',';
SET MoneyDecimalSep='.';
SET MoneyFormat='$#,##0.00;($#,##0.00)';
SET TimeFormat='h:mm:ss TT';
SET DateFormat='M/D/YYYY';
SET TimestampFormat='M/D/YYYY h:mm:ss[.fff] TT';
SET MonthNames='Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec';
SET DayNames='Mon;Tue;Wed;Thu;Fri;Sat;Sun';

LET vScriptStart = now(1);
///$tab Setup
$(Include=..\qvc_runtime\qvc.qvs)

$(Include=..\qvc_source\qvc_incremental_reload.qvs)


// The directory for the QVD file
SET Qvc.Loader.v.QvdDirectory='QVD';

// How far back to load if First Load 
LET Qvc.Loader.v.BaseDate = num(MakeDate(2000,01,01));

// Datetime literal format for Excel - Shipper exercise
SET Qvc.Loader.v.DatabaseDatetimeMask = 'MM/DD/YYYY';

///$tab Load Script
// Calling parameters are Tablename, UpdateColumn, QVD_PrimaryKey.
CALL Qvc.IncrementalSetup ('Rates', 'LastUpdate', 'RateId');  //<=== Change



// Add SQL/LOAD statement here
Directory;
[$(Qvc.Loader.v.Tablename)]:		// vTablename is set by the IncrementalSetup routine.
// Load script goes here. Be sure to include the WHERE condition below.
Directory;
LOAD RateId, 
     Carrier, 
     Origin, 
     Destination, 
     Rate, 
     [Effective date], 
     LastUpdate
FROM
[Rates.xls]
(biff, embedded labels, table is Sheet1$)
WHERE $(Qvc.Loader.v.IncrementalExpression)	// IncrementalExpression is set up the Qvc.IncrementalSetup routine.
;



///$tab Update QVD
// Log the ending stats
Call Qvc.Log ('$(Qvc.Loader.v.Tablename) loaded, rows=' & num(NoOfRows('$(Qvc.Loader.v.Tablename)'), '#,##0'));

// Update the QVD with the changed rows
CALL Qvc.IncrementalStore 
// Log some metadata about the reload.
CALL Qvc.LogMeta ('InputSource=Rates.xls');	//<=== Change		


///$tab Cleanup
LET vLoadDuration = now(1) - vScriptStart;
